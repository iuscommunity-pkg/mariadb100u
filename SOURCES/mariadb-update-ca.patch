--- mariadb-10.0.16/mysql-test/r/mysqlcheck.result	2015-01-25 09:21:38.000000000 -0600
+++ mariadb-10.0.16/mysql-test/r/mysqlcheck.result.17	2015-02-03 08:21:00.925000000 -0600
@@ -1,6 +1,6 @@
 call mtr.add_suppression("Invalid .old.. table or database name");
-DROP TABLE IF EXISTS t1, `t``1`, `t 1`;
-drop view if exists v1;
+DROP TABLE IF EXISTS t1, `t``1`, `t 1`, test.`t.1`, v1;
+drop view if exists t1, `t``1`, `t 1`, test.`t.1`, v1;
 drop database if exists client_test_db;
 mtr.global_suppressions                            OK
 mtr.test_suppressions                              OK
@@ -340,3 +340,10 @@
 Table	Op	Msg_type	Msg_text
 test.bug47205	check	status	OK
 DROP TABLE bug47205;
+#
+#MDEV-6128:[PATCH] mysqlcheck wrongly escapes '.' in table names
+#
+CREATE TABLE test.`t.1` (id int);
+mysqlcheck test t.1
+test.t.1                                           OK
+drop table test.`t.1`;
--- mariadb-10.0.16/mysql-test/r/ssl.result	2015-01-25 09:21:40.000000000 -0600
+++ mariadb-10.0.16/mysql-test/r/ssl.result.17	2015-02-03 08:20:06.596000000 -0600
@@ -3,10 +3,10 @@
 Ssl_cipher	DHE-RSA-AES256-SHA
 SHOW STATUS LIKE 'Ssl_server_not_before';
 Variable_name	Value
-Ssl_server_not_before	Feb 20 02:55:06 2010 GMT
+Ssl_server_not_before	Jan 29 13:33:36 2015 GMT
 SHOW STATUS LIKE 'Ssl_server_not_after';
 Variable_name	Value
-Ssl_server_not_after	Sep  3 02:55:06 2030 GMT
+Ssl_server_not_after	Jan 24 13:33:36 2035 GMT
 drop table if exists t1,t2,t3,t4;
 CREATE TABLE t1 (
 Period smallint(4) unsigned zerofill DEFAULT '0000' NOT NULL,
--- mariadb-10.0.16/mysql-test/t/mysqlcheck.test	2015-01-25 09:21:38.000000000 -0600
+++ mariadb-10.0.16/mysql-test/t/mysqlcheck.test.17	2015-02-03 08:21:40.497000000 -0600
@@ -14,8 +14,8 @@
 #
 
 --disable_warnings
-DROP TABLE IF EXISTS t1, `t``1`, `t 1`;
-drop view if exists v1;
+DROP TABLE IF EXISTS t1, `t``1`, `t 1`, test.`t.1`, v1;
+drop view if exists t1, `t``1`, `t 1`, test.`t.1`, v1;
 drop database if exists client_test_db;
 # Repair any tables in mysql, sometimes the slow_log is marked as crashed
 # after server has been killed
@@ -312,3 +312,13 @@
 CHECK TABLE bug47205 FOR UPGRADE;
 
 DROP TABLE bug47205;
+
+--echo #
+--echo #MDEV-6128:[PATCH] mysqlcheck wrongly escapes '.' in table names
+--echo #
+CREATE TABLE test.`t.1` (id int);
+
+--echo mysqlcheck test t.1
+--exec $MYSQL_CHECK test t.1
+
+drop table test.`t.1`;
--- mariadb-10.0.16/client/mysqlcheck.c	2015-01-25 09:21:38.000000000 -0600
+++ mariadb-10.0.16/client/mysqlcheck.c.17	2015-02-03 12:38:27.589000000 -0600
@@ -521,9 +521,6 @@
   {
     if (*p == '`')
       extra_length++;
-    else if (*p == '.')
-      extra_length+= 2;
-
   }
   DBUG_RETURN((uint) ((p - name) + extra_length));
 }
@@ -537,11 +534,6 @@
   for (; *src; src++)
   {
     switch (*src) {
-    case '.':            /* add backticks around '.' */
-      *dest++= '`';
-      *dest++= '.';
-      *dest++= '`';
-      break;
     case '`':            /* escape backtick character */
       *dest++= '`';
       /* fall through */
@@ -836,13 +828,17 @@
 {
   MYSQL_RES *res;
   MYSQL_ROW row;
-  char prev[(NAME_LEN+9)*2+2];
+  char prev[(NAME_LEN+9)*3+2];
   char prev_alter[MAX_ALTER_STR_SIZE];
+  char *db_name;
+  uint length_of_db;
   uint i;
   my_bool found_error=0, table_rebuild=0;
   DBUG_ENTER("print_result");
 
   res = mysql_use_result(sock);
+  db_name= sock->db;
+  length_of_db= strlen(db_name);
 
   prev[0] = '\0';
   prev_alter[0]= 0;
@@ -866,10 +862,16 @@
           if (prev_alter[0])
             insert_dynamic(&alter_table_cmds, (uchar*) prev_alter);
           else
-            insert_dynamic(&tables4rebuild, (uchar*) prev);
+          {
+            char *table_name= prev + (length_of_db+1);
+            insert_dynamic(&tables4rebuild, (uchar*) table_name);
+          }
         }
         else
-          insert_dynamic(&tables4repair, prev);
+        {
+          char *table_name= prev + (length_of_db+1);
+          insert_dynamic(&tables4repair, table_name);
+        }
       }
       found_error=0;
       table_rebuild=0;
@@ -910,10 +912,16 @@
       if (prev_alter[0])
         insert_dynamic(&alter_table_cmds, prev_alter);
       else
-        insert_dynamic(&tables4rebuild, prev);
+      {
+        char *table_name= prev + (length_of_db+1);
+        insert_dynamic(&tables4rebuild, table_name);
+      }
     }
     else
-      insert_dynamic(&tables4repair, prev);
+    {
+      char *table_name= prev + (length_of_db+1);
+      insert_dynamic(&tables4repair, table_name);
+    }
   }
   mysql_free_result(res);
   DBUG_VOID_RETURN;
